language: python
python:
- '3.8'
sudo: required
services:
- docker
env:
  global:
  - REGISTRY_USER=ocadotechnologygitlab
  - VCS_SOURCE="https://github.com/${TRAVIS_REPO_SLUG}"
  - SNYK_MODE=WARN
  - secure: "z0oUHGGWxqtNuOyGz5DGi83gmAUDcS9ksVJrYVBLGUvgxeUCoYtNyySlLE/81bbKyTdLdeqtv0kEKhCIP1G9a1P+f2D9UCuu/pTSgEgjUlbBJqA+3seckQWt/SnfWr3hU/ySqt0UtB47rRyttZBzQmYgf2ECmDhVASRi3B02ogNHW4wwFBUwwYllotKXijz6NyYO85tzE2SeNrO8G2z0UjpLZAQawL3Whx5ApQeMm6iotDkSoQdUY0BtVap3rjG6wiY5WCBraPMWjlEZKCrbs08T7qqSkiB/RklXAppSSwB5OaLsH68xVE1/ZaNvvKa1YutoubJytyKYHYtVLBOyDOyYYPVn/Kgch0jnLL5hLkoyz8PDrHw2Pop9j+yNUUbEEihQbVpsU518IGX0X/z/jiy/nIcFIBo7diXzg+3w425Nk8iRKdmfaOC/t9/+qhpo+ULVloZcVr2Wv6kM34RDoowjit4SVRCn7XFo5PibQO+5neV0jdS5F/NPCF1LdWBV5uxjlLxcMxwEVTi4uvufRBswpOI2P9B9HY2lF02eLtCC7w90A954uIX/Gjojqy0QMbzKfPCl3IV0Geq5lcYhu8Hz9GqOJC/b81KcnvWGNzKYJjUIAWIWxjremkTMS12dgE8DGTx8p7z7nepWRqV63zVIYcRMP22517wZkTNaxEE="
  - secure: "E3TDS6rQtk6+yeywcVnHiAYOhzKAbUT4QR3yR0HckPa+t89NkJSnWW1BaBzzzI8tzQco5mgJsp1rnWf+9pSkUjQg7b03c+SWAI77jbQuthpcm96bWwZcbg3f5HnDVBESyb+XuH6Hqj3ifp5xx22fCcwJBgZ8RSG3T2o3MFrpgDnjDuzgf8D5nLHGaWSfeXf2ESfh39Uu/9L/DSkKpcZprbVHTG2tL7LXr2XRs5BkiKDBxkeLU3BAfn876DDmD7cvSpsOvccgDK+T0dqXwCxhmHblMNJDNmOXVvmdLC3lKJ8QTHqHHFFps6EmgR41tba+rYGSTRsOwSTh3rt2xausDwffGPDYNsgWBIgkc+cC3FRjUQznpTGcHM2p40FtrHAR7auz5UZsQLcKl+fRJJ4Iz4W3KrHLDXXE3hLB8PRk9+S4cZ5aDxzgmXw0UpKtibMC0EmdRMvS+CGBC9/BL/2e1srhVlkEh+8cN1z2tEGO23I4D0KxdgIrq/ICkvD9XhNc/ic490+Xp2LzlGgpUboWJEOmfKP71bmlGyWm55U1t01/vuRs4J/FT/feI0PEXVckYfY577rDo4k1PloJnbI+hBmzWmG4IJxGIJboEhP2W+cT4zz3ujV/kCI9zGJZ0eHI/r5cqXF5+gHV0ghPeN4ENYSf8AQlfNTmkfErpXS9GYg="
  - secure: "MxGMF+iCHO+kyItflMJZPPeQ3YA4CnZ+KZS2EwDnAE3lJXupMOZGjJOTcJnq+Oij84LIAHx7MRN6e4jyxdW9SSPoq0Pi+ZjrPvZ3T1djFQvhjoUr8MqsNQt0lw6CTIGKze9Q0tAzKoiOaVxwvtqKZY0eo011F8dCh2ScCi1lmjaWwgvbHbA6DMK5/A3yK7mAmEWwROZHw/ZMkdRX5DjpX5KHRRYXLbkdAzKw2ApsAyeSIBUp7M0kQ79hUpDoN3cvTYW4J87qNFZ4hxM3GEqquL90yd77h8Hgl8QDWEiyw2hIlhM/e1tkHgvuhF8vE7IJ31oCogPIvvjVO1re8fvVqVxcpbW9bjJTQ0ymlt42v7khmKIKzNMGivZrQ0gC5qyaxUUBxjikszKvEcsNMv6SbbLKcVbdD1VKZkLDmnElkaXVZDytWEkvBFK6RCOQjJKS2MZcX9k6hOfXqmvYSi6HlSuJIq17gN69DcM8A/5F5NarxsRBE+NlUz2EX4RalR4FaDC6LeHvRAObc9ElYgDvD7+q9ZbVJbcePuFXQeabUPQy/HKpPM3nJVSU/dOky3wKwpDSjhGViHJQh123pdFwCdABjiWd8qkblFGAI599+A+L74eBDgjET+r5/3s/7HvdG4aHl0aFQyAfIJVLUZGRUEXgkTK5YYCCs62x/vNSNOI="
script:
- npm install -g snyk
- python setup.py test
- ./.travis/docker-build.sh
after_script:
- docker images
deploy:
  provider: script
  script: ./.travis/docker-push.sh
  on:
    branch: master
    tags: true
